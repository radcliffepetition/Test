<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Camp Citizen Quiz</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700&display=swap" rel="stylesheet">

<!-- Firebase v10 -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<style>
body {
  background:#111;
  color:white;
  font-family:'Orbitron',sans-serif;
}

.quiz-container {
  max-width:700px;
  margin:120px auto;
  text-align:center;
}

button {
  width:100%;
  padding:18px;
  margin:14px 0;
  font-size:1.2rem;
  border-radius:14px;
  background:rgba(255,255,255,0.15);
  border:1px solid rgba(255,255,255,0.25);
  color:white;
  cursor:pointer;
}

button:hover {
  background:rgba(255,255,255,0.3);
}

input {
  width:100%;
  padding:14px;
  font-size:1.1rem;
  border-radius:10px;
  border:none;
}
</style>
</head>

<body>

<div class="quiz-container">

<!-- EMAIL -->
<div id="email-screen">
  <h1>Enter Your Email</h1>
  <input id="userEmail" type="email" placeholder="you@example.com">
  <button onclick="saveEmail()">Continue</button>
</div>

<!-- START -->
<div id="start-screen" style="display:none;">
  <h1>Take the Quiz?</h1>
  <button onclick="showNotice()">Start</button>
</div>

<!-- NOTICE -->
<div id="notice-screen" style="display:none;">
  <h1>Before You Start</h1>
  <p>This quiz has no right or wrong answers.</p>
  <button onclick="startQuiz()">OK</button>
</div>

<!-- QUIZ -->
<div id="question-screen" style="display:none;">
  <h2 id="question-text"></h2>
  <div id="answers"></div>
</div>

<!-- END -->
<div id="end-screen" style="display:none;">
  <h1>Quiz Complete!</h1>
  <p>Your response was sent for review.</p>
</div>

</div>

<script>
/* ================= FIREBASE ================= */
firebase.initializeApp({
  apiKey: "AIzaSyD4bDMS9X_HqSDa-2qVTZKNNsXVVA1A1A4",
  authDomain: "gggg-2095f.firebaseapp.com",
  projectId: "gggg-2095f"
});

const db = firebase.firestore();

/* ================= QUIZ DATA ================= */
const questions = [
  { text:"When did you join Star Citizen?", answers:["Before 2020","2020â€“2022","Recently","Never"] },
  { text:"How experienced are you?", answers:["Beginner","Intermediate","Advanced","Expert"] },
  { text:"Why do you want to join?", written:true },
  { text:"What can you contribute?", written:true }
];

let current = 0;
let responses = [];

/* ================= EMAIL ================= */
function saveEmail() {
  const email = document.getElementById("userEmail").value.trim();

  if (!email || !email.includes("@")) {
    alert("Enter a valid email");
    return;
  }

  localStorage.setItem("quizEmail", email);

  document.getElementById("email-screen").style.display = "none";
  document.getElementById("start-screen").style.display = "block";
}

/* ================= FLOW ================= */
function showNotice() {
  document.getElementById("start-screen").style.display = "none";
  document.getElementById("notice-screen").style.display = "block";
}

function startQuiz() {
  document.getElementById("notice-screen").style.display = "none";
  document.getElementById("question-screen").style.display = "block";
  loadQuestion();
}

/* ================= QUIZ LOGIC ================= */
function loadQuestion() {
  const q = questions[current];
  document.getElementById("question-text").textContent = q.text;
  const area = document.getElementById("answers");
  area.innerHTML = "";

  if (q.written) {
    const input = document.createElement("input");
    input.placeholder = "Type your answer...";
    area.appendChild(input);

    const btn = document.createElement("button");
    btn.textContent = "Submit";
    btn.onclick = () => submitAnswer(input.value);
    area.appendChild(btn);
  } else {
    q.answers.forEach(a => {
      const btn = document.createElement("button");
      btn.textContent = a;
      btn.onclick = () => submitAnswer(a);
      area.appendChild(btn);
    });
  }
}

function submitAnswer(ans) {
  if (!ans) return alert("Please answer");

  responses.push({
    question: questions[current].text,
    answer: ans
  });

  current++;

  if (current >= questions.length) finishQuiz();
  else loadQuestion();
}

/* ================= FINISH ================= */
function finishQuiz() {
  db.collection("quizSubmissions").add({
    email: localStorage.getItem("quizEmail"),
    responses: responses,
    approved: false,
    submittedAt: firebase.firestore.FieldValue.serverTimestamp()
  });

  document.getElementById("question-screen").style.display = "none";
  document.getElementById("end-screen").style.display = "block";
}
</script>

</body>
</html>
